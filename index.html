<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wasabi Wallet Coinjoin Coordinator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav>
        <ul>
            <li><a href="index.html">Coinjoin Coordination Service</a></li>
            <li><a href="guide.html">Bitcoin Privacy Guide</a></li>
            <li><a href="support.html">FAQ & Support</a></li>
        </ul>
    </nav>
    <div class="content">
        <h1>Wasabi Wallet Coinjoin coordinator by Kruw</h1>
        <p>I am coordinating coinjoins for Wasabi Wallet & BTCPay Server for FREE! To participate, paste this in your settings:</p>
        <code id="copyText">https://btcpay.kruw.io/plugins/wabisabi-coordinator/</code>
        <button onclick="copyToClipboard()">Copy</button>

        <h2>Round Information</h2>
        <p>Current Input Count: <span id="inputCount">Loading...</span></p>
        <p>Input Registration Remaining: <span id="inputRegistrationRemaining">Loading...</span></p>

        <h2>Go to the Coordinator Settings from the coinjoin status box</h2>
        <img src="https://raw.githubusercontent.com/Kruwed/kruwed.github.io/master/images/Shortcut.png" alt="Change coordinator" style="max-width: 100%; height: auto;">

        <h2>Paste the connection info and click the "Restart Wasabi" text</h2>
        <img src="https://raw.githubusercontent.com/Kruwed/kruwed.github.io/master/images/Switch%20Coordinator.png" alt="Restart Wasabi" style="max-width: 100%; height: auto;">

    </div>
    <script>
        function copyToClipboard() {
            var copyText = document.getElementById("copyText");
            var tempInput = document.createElement("input");
            tempInput.value = copyText.textContent;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand("copy");
            document.body.removeChild(tempInput);
        }

        function fetchRoundData() {
            fetch('https://btcpay.kruw.io/plugins/wabisabi-coordinator/wabisabi/human-monitor')
                .then(response => response.json())
                .then(data => {
                    const roundData = data.RoundStates[0];
                    document.getElementById('inputCount').textContent = roundData.InputCount;
                    document.getElementById('inputRegistrationRemaining').textContent = roundData.InputRegistrationRemaining;
                })
                .catch(error => {
                    console.error('Error fetching round data:', error);
                });
        }

        // Fetch the data immediately when the page loads
        window.onload = fetchRoundData;

        // Optionally, refresh the data every 60 seconds
        setInterval(fetchRoundData, 60000);
    </script>
</body>
</html>

